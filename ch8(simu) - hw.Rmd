---
title: "ç¬¬å…«ç« (éšæœºæ•°ç”Ÿæˆä¸æ¨¡æ‹Ÿ) -ä½œä¸š"
author: "æœ±å­ç 2019193014"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## ç»ƒä¹ é¢˜

1. å‡è®¾ä¸€ä¸ªç”µå­ä»ªå™¨çš„ä½¿ç”¨å¯¿å‘½æœä»ä¸€ä¸ªæŒ‡æ•°åˆ†å¸ƒ$\mbox{exp}(\lambda)$ï¼Œåˆ¶é€ å•†æƒ³çŸ¥é“ï¼Œå¦‚æœä»–ä»¬æµ‹è¯•ğ‘ä¸ªäº§å“ï¼Œè‡³å°‘ğ‘¡ä¸ªäº§å“çš„ä½¿ç”¨å¯¿å‘½å¤§äºâ„å°æ—¶çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿè®¾ç½®$c=100,h=2,t=15,\lambda=1$ã€‚å¯ä»¥ä½¿ç”¨Rè‡ªå¸¦å‡½æ•°`rexp()`ã€‚

```{r}
times=1e5
c=100
lambda=1
t=15
h=2
result=c()
for(j in 1:times){
    test_result=rexp(c,lambda)
    count=0
    for(i in 1:100){
        if(test_result[i]>h)
            count=count+1}
    if(count>=t)
        result[j]=1
}
res=na.omit(result)
prob=length(res)/times
prob
```

2. å‡è®¾æ€»ä½“ä¸º$\{x_1,x_2,\ldots,x_n\}$ï¼Œç¼–ç¨‹å®ç°ä»è¯¥æ€»ä½“ä¸­**æ— æ”¾å›**æŠ½å–æ ·æœ¬$\{y_1,y_2,\ldots,y_k\}$($K\leq n$)ã€‚**ä¸èƒ½**ä½¿ç”¨Rè‡ªå¸¦çš„å‡½æ•°`sample()`ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨Rè‡ªå¸¦å‡½æ•°`runif()`ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯èƒ½çš„æµç¨‹ï¼š

    - åˆå§‹é›†åˆä¸º$\{3,2,20,5,6,100,99,80,7,17\}$
    - è¿˜æ²¡æœ‰è¢«æŠ½å–çš„å…ƒç´ çš„é›†åˆä¸ºåˆå§‹é›†åˆ
    - å·²æŠ½å–å…ƒç´ é›†åˆä¸ºç©ºé›†
    - å¾ªç¯$5$æ¬¡ï¼š
        - ä»è¿˜æ²¡æœ‰è¢«æŠ½å–çš„å…ƒç´ çš„é›†åˆä¸­æŠ½å–ä¸€ä¸ªå…ƒç´ 
        - æŠŠè¯¥å…ƒç´ æŠ½å–åˆ°çš„å…ƒç´ åŠ å…¥åˆ°å·²æŠ½å–å…ƒç´ é›†åˆ
        - æŠŠè¯¥å…ƒç´ ä»è¿˜æ²¡æœ‰è¢«æŠ½å–çš„å…ƒç´ çš„é›†åˆä¸­åˆ é™¤
        
```{r}
data=c(3,2,20,5,6,100,99,80,7,17)
res=c()
for (i in 1:5) {
    num=runif(1)
    b=floor((10-i+1)*num+1)
    res[i]=data[b]
    data=data[-b]
}
data
res
```

3. éšæœºå˜é‡$X$çš„åˆ†å¸ƒå¾‹ä¸º
$$P(X=1)=0.1, P(X=2)=0.3, P(X=5)=0.6$$
    - è®¡ç®—$X$çš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°
    - ç¼–ç¨‹äº§ç”Ÿ$X$çš„éšæœºæ•°(å¯ä»¥ä½¿ç”¨å‡½æ•°`runif()`)
 
```{r}
#if(x<1)
    #fx=0 else if(x>=1&&x<2)
        #fx=0.1 else if(x>=2&&x<5)
            #fx=0.1+0.3 else if(x==5)
                #=0.1+0.3+0.6
```
```{r}
sample=runif(10,0,1)
result=c()
for(i in 1:length(sample)){
    if(sample[i]<=0.1)
        result[i]=1
    else if(sample[i]>0.1&sample[i]<=0.4)
        result[i]=2
    else if(sample[i]>=0.4&sample[i]<=1)
        result[i]=5
}
res=na.omit(result)
res
```
   
4. äº§ç”Ÿ$\mbox{Poisson}(\lambda)$çš„éšæœºæ•°ã€‚å°è¯•$\lambda=5$ã€‚æ³¨ï¼š**ä¸èƒ½**ä½¿ç”¨Rè‡ªå¸¦çš„å‡½æ•°`rpois()`ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨Rè‡ªå¸¦å‡½æ•°`runif()`

   æ³Šæ¾åˆ†å¸ƒçš„åˆ†å¸ƒå¾‹ä¸º
$P(X=x)=\frac{e^{-\lambda} \lambda^x}{x!}$ã€‚å®ƒçš„é€’å½’è¡¨è¾¾å¼ä¸º
$$
p(x+1)=\frac{\lambda}{x+1}p(x).
$$
```{r}
vec=rep(NA,11)
vec[1]=0
res=c()
for(i in 1:10){
    vec[i+1]=(5^i)*(exp(-5))/(gamma(i+1))
}
for (i in 11:3) {
    sum=vec[1:i-1]
    vec[i]=sum(sum)+vec[i]
}
for(j in 1:1e5){
    y=runif(1,0,1)
    for (i in 1:10) {
        if(vec[i]<y&y<vec[i+1]){
            res[length(res)+1]=i
            break
        }
    }
    j=j+1
}
head(res)
```


5. è€ƒè™‘è¿ç»­éšæœºå˜é‡$X$ï¼Œå®ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º
$$
f_X(x)=\frac{\mbox{exp}(-x)}{(1+\mbox{exp}(-x))^2} \quad -\infty<x<\infty
$$
è¯¥åˆ†å¸ƒè¢«ç§°ä¸ºæ ‡å‡†é€»è¾‘åˆ†å¸ƒ(standard logistic distribution). è¯·åŒå­¦ä»¬ä½¿ç”¨é€†å˜æ¢æ³•äº§ç”Ÿæœä»è¯¥åˆ†å¸ƒçš„éšæœºæ•°ã€‚
```{r}
sample=runif(1e5)
res=c()
for (i in 1:1e5) {
    res[i]=log(sample[i]/(1-sample[i]))
}
head(res)
```
6. è€ƒè™‘gammaåˆ†å¸ƒ$\Gamma(\lambda, m)$ï¼Œå®ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º
$$
f(x)=\lambda^m x^{m-1} e^{-\lambda x}/\Gamma(m) \quad x>0
$$
å¯¹äºgammaåˆ†å¸ƒï¼Œæˆ‘ä»¬æ— æ³•å¾—åˆ°å®ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼Œä»¥åŠç´¯ç§¯åˆ†å¸ƒå‡½æ•°çš„é€†å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•ä½¿ç”¨é€†å˜æ¢æ³•äº§ç”Ÿéšæœºæ•°ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ‹’ç»æ³•äº§ç”Ÿéšæœºæ•°ã€‚
æˆ‘ä»¬å¯ä»¥è®©$h(x)$ä¸ºæŒ‡æ•°åˆ†å¸ƒ$\mu e^{-\mu x},x>0$ã€‚

    æŒ‡æ•°åˆ†å¸ƒçš„éšæœºæ•°å¾ˆå®¹æ˜“é€šè¿‡é€†å˜æ¢æ³•å¾—åˆ°ï¼Œ$-\mbox{log}(U)/\mu$ï¼Œå…¶ä¸­ï¼Œ$U\sim Uniform(0,1)$;
    
    åœ¨æ‹’ç»æ³•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—$k$ï¼Œ
$$
k=\mbox{sup}_{x>0}\frac{f(x)}{h(x)}=\mbox{sup}_{x>0}\frac{\lambda^m x^{m-1} e^{(\mu-\lambda) x}}{\mu \Gamma(m)}
$$
ä»ä¸Šå¼å¯ä»¥çœ‹åˆ°ï¼Œå½“$m<1$æˆ–$\lambda \leq \mu$æ—¶ï¼Œ$k$å°†æ˜¯æ— ç©·å¤§ã€‚å› æ­¤ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾$m>1$ï¼Œä¸”é€‰æ‹©$\mu<\lambda$ã€‚
    æ¥ç€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ±‚ä¸Šå¼çš„å¯¼æ•°å¾—åˆ°ï¼Œå½“$x=(m-1)/(\lambda-\mu)$æ—¶ï¼Œ$k$å€¼å¯ä»¥å–åˆ°æœ€å¤§å€¼
    $$
    k=\frac{\lambda^m(m-1)^{m-1}e^{-(m-1)}}{\mu(\lambda-\mu)^{m-1}\Gamma(m)}
    $$
    åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥è°ƒèŠ‚$\mu$çš„å¤§å°ï¼Œæ”¹å˜$k$çš„å€¼ã€‚æˆ‘ä»¬å¸Œæœ›$k$å°½å¯èƒ½çš„å°ã€‚é€šè¿‡ä¸Šå¼å¯ä»¥çœ‹åˆ°ï¼Œå½“$\mu(\lambda-\mu)^{m-1}$æœ€å¤§æ—¶ï¼Œ$k$æœ€å°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€šè¿‡æ±‚$\mu(\lambda-\mu)^{m-1}$çš„å¯¼æ•°ï¼Œå¾—åˆ°å½“$\mu=\lambda/m$æ—¶ï¼Œ $k$æœ€å°ã€‚è¿™æ—¶ï¼Œ$k=m^me^{-(m-1)}/\Gamma(m)$ã€‚
    è¯·åŒå­¦ä»¬ç¼–ç¨‹äº§ç”Ÿæœä»gammaåˆ†å¸ƒçš„éšæœºæ•°ã€‚å°è¯•$\lambda=1, m=2$ã€‚æ³¨ï¼š$\Gamma(m)$å¯ä»¥é€šè¿‡å‡½æ•°`gamma(m)`è®¡ç®—ã€‚
    
```{r}
k=exp(-1)/(0.5*0.5*gamma(2))
sam1=runif(1e5)*k
sam2=rexp(1e5,0.5)
sample=sam1*sam2
res=c()
for (i in 1:1e5) {
    if(sample[i]<(sam2[i]*exp(-sam2[i])/gamma(2))){
        res[length(res)+1]=sam2[i]
    }
}
head(res)
```

7. ä¸­å¿ƒæé™å®šç†ï¼šå½“$X_1,X_2,\ldots,X_n$ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œä¸”$E(X)=\mu$ï¼Œ
$Var(X)<\infty$æ—¶ï¼Œå®šä¹‰$\bar{X}=\frac{1}{n}\sum_{i=1}^n X_i$ï¼Œ
$\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}$è¿‘ä¼¼æœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚å› æ­¤ï¼Œæ ¹æ®ä¸­å¿ƒæé™å®šç†ï¼Œæˆ‘ä»¬å¯ä»¥äº§ç”Ÿæœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„éšæœºæ•°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è®©$X_i\sim \mbox{Uniform}(0,1),i=1,\ldots,n$,$n$æ˜¯ä¸€ä¸ªè¾ƒå¤§çš„æ•°ã€‚è¿™æ—¶$EX=0.5,Var(X)=1/12$ã€‚

    - è¯·æ ¹æ®ä¸­å¿ƒæé™å®šç†ç¼–ç¨‹äº§ç”Ÿæœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„éšæœºæ•°ã€‚
    - å¹¶äº§ç”Ÿæœä»æ­£æ€åˆ†å¸ƒ$N(30,4)$çš„éšæœºæ•°ã€‚

```{r}
sample=runif(1e5)
for (i in 1:63) {
    sample=sample+runif(1e5)
}
sample=sample/64
res1=8*(sample-0.5)/sqrt(1/12)
res2=res1*2+30
head(res1)
head(res2)
```

8. å‡è®¾$X$å’Œ$Y$éƒ½æ˜¯æœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œæ±‚$E[\mbox{max}(X,Y)]$ã€‚
```{r}
x=rnorm(1e6)
y=rnorm(1e6)
res=c()
for(i in 1:1e6){
    if(x[i]>y[i])
        res[i]=x[i]
    else if(x[i]<=y[i])
        res[i]=y[i]
}
mean(res)
```

9. è’™æéœå°”é—®é¢˜ï¼šå‡å¦‚ä½ å‚ä¸ä¸€ä¸ªæœ‰ä¸»æŒäººçš„æ¸¸æˆï¼Œä½ ä¼šçœ‹è§ä¸‰æ‰‡å…³é—­äº†çš„é—¨ï¼Œå…¶ä¸­ä¸€æ‰‡çš„åé¢æœ‰ä¸€è¾†æ±½è½¦ï¼Œå¦å¤–2æ‰‡é—¨åé¢å„æ˜¯ä¸€åªå±±ç¾Šï¼Œä½ çœ‹ä¸è§é—¨åé¢çš„æƒ…å†µï¼Œä½†ä¸»æŒäººçŸ¥é“ä¸€åˆ‡ã€‚ä½ è¢«ä¸»æŒäººè¦æ±‚åœ¨ä¸‰æ‰‡é—¨ä¸­é€‰æ‹©ä¸€æ‰‡ï¼Œä½†ä¸èƒ½æ‰“å¼€ï¼Œåœ¨ä½ é€‰å®šä¹‹åä¸»æŒäººå¼€å¯äº†å¦ä¸€æ‰‡åé¢æœ‰å±±ç¾Šçš„é—¨ï¼Œç„¶åä½ å¯ä»¥åšæŒåŸæ¥é€‰å®šçš„é—¨ï¼Œä¹Ÿå¯ä»¥æ”¹ä¸»æ„é‡æ–°é€‰æ‹©ã€‚é—®é¢˜æ˜¯ï¼šæ”¹ä¸ä¸æ”¹å¯¹é€‰ä¸­æ±½è½¦çš„æ¦‚ç‡æœ‰å½±å“å—ï¼Ÿè¯·ä½¿ç”¨æ¨¡æ‹Ÿå®éªŒçš„æ–¹æ³•å›ç­”è¯¥é—®é¢˜ã€‚

```{r}
times=1e6
door=c(0,0,1)
#æ¢é—¨
res=c()
for(i in 1:times){
    choice=runif(1,0,1)
    if(choice>(1/3))
        res[i]=0
    else if(choice<=(1/3))
        res[i]=1
    if(res[i]==0){
        newdoor=c(0,1)
        newchoice=runif(1,0,1)
        if(newchoice>=0.5)
            res[i]=0
        else if(newchoice<0.5)
            res[i]=1
    }
}
result=res[res==1]
prob=length(result)/times
prob
```

```{r}
times=1e6
door=c(0,0,1)
#ä¸æ¢é—¨
res=c()
for(i in 1:times){
    choice=runif(1,0,1)
    if(choice>(1/3))
        res[i]=0
    else if(choice<=(1/3))
        res[i]=1
}
result=res[res==1]
prob=length(result)/times
prob
```
ç»“è®ºï¼šæœ‰å½±å“ï¼Œæ¢é—¨çš„è¯ä¸­è½¦æ¦‚ç‡ä¸º2/3ï¼Œä¸æ¢é—¨çš„è¯ä¸­è½¦æ¦‚ç‡ä¸º1/3


